---
title: "Javaレガシー帳票出力アプリをPythonにリメイクする"
emoji: "📄"
type: "tech"
topics: ["flask", "postgres", "python", "json"]
published: false
---

### 0. はじめに

昔SIerにて、以下の構築の案件に関わったことがある。

![](https://storage.googleapis.com/zenn-user-upload/5ed119463edb-20250722.png)

この帳票出力アプリの構築では、
ユーザがJavaScript UIの画面に入力した値をバックエンド側で処理し,
生成されたSQLでDBに問い合わせ、結果をもとにPDFを生成する。

しかし、帳票出力処理とバックエンド処理が密結合なため動作が重く、
保守性も拡張性も絶望的であった。
フロントとバックが密に絡んでて「改修したくても壊れる」状態であった。

これらの経験から、軽量でモダンな構築で実現できないか考察した。

* この記事の目的：

  * レガシーJava+MyBatisアプリの構成・設計課題を洗い出し、Flaskでバックエンド中心に再構築した話
  * UI/UXではなく、**構成とデータ設計・PDF生成のロジック中心**
* 作ったもの：

  * 画面は1つ、テーブルも1つ。**でも業務アプリとして必要な流れは通ってる**
* この記事は誰向け？

  * Flaskでバックエンドアプリ作ってみたい人
  * シンプルな画面でもちゃんと考えた実装が知りたい人
  * 「レガシー帳票アプリに詰まってる人」

---

### 1. Flaskで作り直したときの構成メモ

以下の記事で Python + Postgres + Apache2 の開発環境を作成済み(この構築ではApacheは未使用)
@[card](https://zenn.dev/nickelth/articles/ubuntuenvsetup)

また、WSL上でVSCodeを起動できるようにしている。

![](https://storage.googleapis.com/zenn-user-upload/1f7e780ce3d6-20250722.png)
- Python + Flask + Jinja2 + PostgreSQL（※ORMはSQLAlchemyでもいいし、生でもいい）
- 帳票出力処理は分離独立

``` markdown:ディレクトリ構成
.
├── Dockerfile
├── README.md
├── app.py               --アプリ実行ファイル
├── docker-compose.yml
├── init.sql             --DB初期化用SQL
├── requirements.txt     --Pythonパッケージの依存関係記録
├── static               
│   └── style.css
└── templates
    ├── index.html
    ├── layout.html
    └── report.html
```
- アプリ実行部は`app.py`のみのシンプル実装。
- `layout.html`を繰返しのベースとし、画面部は`index.html`、帳票部は`report.html`に分けて責務を明確化。
- バックエンド主軸のため、CSSなどUI部分は最小限の構成にとどめる。レスポンシブ対応も省略。

---

### 2. 実装の主軸：バックエンドロジックの分離とPDF出力

* 入力補助（オートコンプリートなど）は**バックエンドからの返却形式を工夫した話**を軽く
* 帳票生成ロジックはどこに分離したか？（`services/` or `utils/`）

  * PDF生成の実装：HTMLテンプレート → PDF化のツール構成（WeasyPrint, wkhtmltopdf など）
  * スタイルに時間かけすぎず、それでも最低限見栄えするようにした工夫
* 保守性のための分離構造（“このへんは現場で効く”感ある）

---

### 3. 入力画面＋PDF出力結果

* 入力画面＋PDF出力結果のスクショ or GIF
* UIの見た目を語らず「どうデータを流してどう責務を分けたか」を説明
* レスポンシブ未対応について：

  * 「フロント側は必要最小限、スマホ対応は今回の目的から外れるため省略」

---

### 4. 実務的な学び・設計意識のメモ

* 画面やテーブル数じゃない、業務アプリに必要なロジックを見極めること
* 再構築を通じて得た「保守しやすさ」「分かりやすい責務分離」の重要性
* フルスタック風に見えて**あくまでバックエンド視点で作ってる**ことの明記

---

### 5. おわりに

* 見た目以上に、帳票PDFの出力って裏側が大事な話
* 実務経験をもとに、「動くだけじゃない構成」にしたつもり
* 次の展開（CI/CD化、S3保存、LambdaでPDF出力など）も今後検討中 みたいに締めても良し

---

## 記事のトーンのヒント

* 地味だけど、設計はちゃんとやってるよ？感を出す
* 「画面は1つ、でも戦ってたのは構造」って伝えると強い
* テンションを上げすぎず、「再設計ってこういうこと」という姿勢を淡々と書くとZennっぽい